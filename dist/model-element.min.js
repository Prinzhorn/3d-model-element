(function(){'use strict';var a={normalize:(a)=>{let b=new THREE.Box3().setFromObject(a),c=new THREE.Vector3;b.getCenter(a.position),b.getSize(c);let d=1/Math.max(c.x,c.y);return a.position.multiplyScalar(-d),a.scale.set(d,d,d),a},createDebugBoundingBox:()=>{let a=new THREE.LineBasicMaterial({color:65280}),b=new THREE.PlaneGeometry(1,1),c=new THREE.WireframeGeometry(b),d=new THREE.LineSegments(c,a);return d},createContainer:(a)=>{let b=new THREE.Object3D;return!1,b.add(a),b}};var b={getFileExtension:(a)=>{let b=a.split(/[?#]/)[0],c=b.split('/'),d=c.pop(),e=d.split('.');if(0<e.length)return'.'+e.pop()}};const c={},d=(d)=>{let e,f,g=b.getFileExtension(d);return(g&&(e=c[g]),!e)?(console.error(`Couldn't load "${d}". Unknown object format "${g}"`),Promise.reject()):(f=e.objectCache[d],f||(f=e.load(d).then((b)=>(a.normalize(b),a.createContainer(b))),e.objectCache[d]=f),f.then((a)=>a.clone()))};var e={load:d,register:(a,b)=>{c[a]={load:b,objectCache:{}}}};const f=(a)=>parseFloat(a||0);var g={parseTransformValue:(a,b)=>{var d=a.split(/\s*[(),]\s*/).slice(1,-1);6===d.length?b.set(+d[0],-d[2],0,+d[4],-d[1],+d[3],0,-d[5],0,0,1,0,0,0,0,1):16===d.length?b.set(+d[0],-d[4],+d[8],+d[12],-d[1],+d[5],-d[9],-d[13],+d[2],-d[6],+d[10],+d[14],+d[3],+d[7],+d[11],+d[15]):b.identity()},parseOriginValue:(a,b)=>{let c=a.split(' ');b.set(f(c[0]),f(c[1]),f(c[2]))},parseUnitValue:f};const h=(a)=>{let b=document.createElement('style');return b.textContent=a,b};var i={getTransformForElement:(a)=>{let b=new THREE.Matrix4,c=new THREE.Matrix4,d=new THREE.Vector3,e=new THREE.Matrix4,f=new THREE.Vector3,h=a,i=[],j=0,k=0,l=0;if(0===a.offsetWidth||0===a.offsetHeight)return{matrix:b};for(j-=a.offsetWidth/2,k+=a.offsetHeight/2;a;)a===h&&(j+=a.offsetLeft,k+=a.offsetTop,h=a.offsetParent),i.push(a),j-=a.scrollLeft,k-=a.scrollTop,a=a.parentElement;for(b.makeTranslation(j,-k,0);a=i.pop();){let h=getComputedStyle(a),i=h.perspective;if('none'!==i){l=g.parseUnitValue(i);let a=h.perspectiveOrigin;a&&g.parseOriginValue(a,f)}g.parseOriginValue(h.transformOrigin,d),g.parseTransformValue(h.transform,c);let j=d.x-a.offsetWidth/2,k=d.y-a.offsetHeight/2,m=d.z;0!=j||0!=k||0!==m?(b.multiply(e.makeTranslation(j,-k,m)),b.multiply(c),b.multiply(e.makeTranslation(-j,k,-m))):b.multiply(c)}return{matrix:b,perspective:l,perspectiveOrigin:f}},createStylesheet:h};let j,k,l,m,n,o,p,q;const r=()=>!p&&(p=new THREE.Scene,q=new THREE.DirectionalLight(16777215,1),q.position.set(0,0,1),p.add(q),o=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),requestAnimationFrame(x),o.domElement),s=(a)=>{p.add(a)},t=(a)=>{p.remove(a)},u=()=>{let a=!1;return k=window.innerWidth,l=window.innerHeight,j=null,p.children.forEach((b)=>{let c=b.elem;if(c){let a=c.offsetWidth,d=i.getTransformForElement(c);j||(d.perspective?j=w(d.perspective,d.perspectiveOrigin):j=v()),b.rotation.setFromRotationMatrix(d.matrix),b.position.setFromMatrixPosition(d.matrix),b.scale.setFromMatrixScale(d.matrix),b.scale.multiplyScalar(a||1),b.position.x+=a-k/2,b.position.y+=l/2}a||(a=!0)}),j&&a},v=()=>{let a;return n||(n=new THREE.OrthographicCamera),a=n,a.left=-k/2,a.right=k/2,a.top=l/2,a.bottom=-l/2,a.far=2e3,a.near=-700,a.updateProjectionMatrix(),a},w=(a,b)=>{let c;m||(m=new THREE.PerspectiveCamera),c=m,c.fov=180*(2*Math.atan(l/2/a))/Math.PI,c.aspect=k/l,c.position.set(0,0,a),c.updateProjectionMatrix();let d=k/2-b.x,e=l/2-b.y;if(0!=d||0!=e){let a=c.projectionMatrix.clone();c.projectionMatrix.makeTranslation(-d/(k/2),e/(l/2),0),c.projectionMatrix.multiply(a),a.makeTranslation(d,-e,0),c.projectionMatrix.multiply(a)}return c},x=()=>{requestAnimationFrame(x),u()&&(o.setSize(k,l),o.render(p,j))};var y={init:r,add:s,remove:t,render:x};const z=new WeakMap;let A;const B=()=>{A=i.createStylesheet('#x-model-renderLayer{position:fixed;top:0;left:0;pointer-events:none}x-model{display:inline-block;width:250px;height:250px}');let a=document.documentElement.firstChild;a.insertBefore(A,a.firstChild);let b=y.init();b.setAttribute('id','x-model-renderLayer'),document.documentElement.appendChild(b)};class C extends HTMLElement{constructor(){super()}static get observedAttributes(){return['src']}connectedCallback(){A||B();let a=z.get(this);a&&a.elem!==this&&(a.elem=this,y.add(a))}disconnectedCallback(){let a=z.get(this);a&&a.elem===this&&(y.remove(a),a.elem=null)}attributeChangedCallback(a,b,c){'src'===a&&(this.disconnectedCallback(),e.load(c).then((a)=>{let b=new UIEvent('load');this.dispatchEvent(b),z.set(this,a),this.connectedCallback()}).catch(()=>{let a=new UIEvent('error');this.dispatchEvent(a)}))}}let D;var E=(a)=>new Promise((b,c)=>{return D||(D=new THREE.GLTFLoader),D.load(a,(a)=>{b(a.scene)},null,()=>{c()})});let F;var G=(a)=>new Promise((b,c)=>{return F||(F=new THREE.OBJLoader),F.load(a,(a)=>{b(a)},null,()=>{c()})});if('customElements'in window){if(!('THREE'in window))throw'THREE (threejs.org) is required.';'GLTFLoader'in THREE&&e.register('.gltf',E),'OBJLoader'in THREE&&e.register('.obj',G),customElements.define('x-model',C)}})();